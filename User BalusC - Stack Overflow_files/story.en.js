"use strict";var StackExchangeDevStory;!function(){var e=function(e,t,n,i){if(e.length){var o=StackOverflow.Models.Story.UserStoryItemTypeId[n.attr("data-typeid")];if(void 0==o)return;e.typeWatch({"highlight":!1,"wait":500,"captureLength":-1,"callback":function(){var r=e.closest("form");e.closest(".coverable-input.input-loader").addClass("loading"),$.ajax({"type":"POST","url":"/users/story/"+StackExchange.user.options.userId+"/search-lists-autocomplete","data":{"query":e.val(),"fkey":StackExchange.options.user.fkey,"itemType":o}}).done(function(o){var a=e.closest(".autocomplete");a.find(".autocomplete-suggestions-list").remove(),e.closest(".coverable-input.input-loader").removeClass("loading");var s=$(o).insertAfter(e).on("click",".autocomplete-suggestion, .autocomplete-default",function(e){var o=$(e.currentTarget);if(o.hasClass("autocomplete-default"))return r.find(t).focus(),!1;var a=o.data("list-id"),s=o.find(".autocomplete-suggestion-image [data-url]"),c=o.find(".autocomplete-suggestion-match").text(),u=s.data("url"),l=s.data("resized-url"),d=o.find(".autocomplete-suggestion-url").text();return i&&i(n,{"name":c,"imageUrl":u,"resizedImageUrl":l,"url":d,"listId":a}),r.find(t).focus(),!1});e.is(":focus")||s.hide()})}})}},t=(function(){function e(){this._newItems=null,this._addItemIsVisible=!1,this._editStarted=!1,this._loadingForm=!1,this._mustUse=$(".additem-body").length>0}return Object.defineProperty(e.prototype,"mustUse",{"get":function(){return this._mustUse},"enumerable":!0,"configurable":!0}),Object.defineProperty(e.prototype,"isAddingItem",{"get":function(){return this._addItemIsVisible},"enumerable":!0,"configurable":!0}),e.prototype.afterSaveOrCancel=function(){this.mustUse&&this._hideAddItemForm()},e.prototype._hideAddItemForm=function(){$("#add-new-item-form").html("").css({"margin-top":"","left":""}).removeClass("with-upper-arrow").addClass("empty-add-new-item-form"),$("#page-cover").hide(),$(".tooltip").show(),this._clickedButton.css({"background":"","z-index":"initial"}),this._addItemIsVisible=!1},e.prototype.init=function(){var e=this;if(this.mustUse){var t=function(t){return e._addItemIsVisible&&!e._editStarted&&e._hideAddItemForm(),t.preventDefault(),!1};$("#page-cover").on("click",function(e){return t(e)}),$("#add-new-item-form").on("click",function(e){return"add-new-item-form"===e.target.id?t(e):!0}),$("#show-more-item-types-button").on("click",function(){$("#more-add-item-buttons").show()}),this._addItem=$(".additem-body"),$(document).keyup(function(t){e._addItemIsVisible&&(27!==t.keyCode||e._editStarted?e._editStarted=!0:e._hideAddItemForm())}),$(document).on("click",".additem-body .-item",function(t){if("show-more-item-types-button"===t.target.closest("li").id)return $(".initially-hidden").css("visibility","visible"),$("#show-more-item-types-button").hide(),void 0;if(e._addItemIsVisible)return e._hideAddItemForm(),void 0;if(!e._loadingForm){var n=$(t.target.closest(".-item")).attr("data-add-item-link");n&&(e._loadingForm=!0,$.ajax(n).done(function(n){e._loadingForm=!1;var i=$(n);i.addClass("nopseudos"),$("#page-cover").show(),$("#add-new-item-form").append(i).addClass("with-upper-arrow").css("z-index","1000");var o=$(t.target).closest(".-item"),r=$("#item-add");e._clickedButton=o;var a,s,c=$("#item-add").css("background-color"),u=o.position().top-58,l=$("#add-item-buttons-container").width()/2;o.position().left+o.width()<l?(a=o.position().left,s=o.width()/2):(a=o.position().left+o.width()-r.outerWidth(),s=r.outerWidth()-o.width()/2),$("#add-new-item-form").append("<style>#add-new-item-form::before{ border-bottom-color: "+c+"; left:"+s+"px}</style>").removeClass("empty-add-new-item-form"),$("#add-new-item-form .timeline-item").css({"border":"0"}),$("#add-new-item-form").css({"margin-top":u,"left":a}),$(".tooltip").hide(),o.css({"background":"white","z-index":1e3}),$(".item-cancel-button").on("click",function(t){return t.preventDefault(),e._hideAddItemForm(),!1}),e._addItemIsVisible=!0,e._editStarted=!1}))}})}},e}(),!1);StackExchange.user.initTimeline=function(){if(!t){t=!0,$(document).on("click",".timeline form :submit, .job-requirements-form :submit",function(e){$(e.target).data("clicked",!0)}),$(document).on("submit",".timeline form, .job-requirements-form",function(e){var t=$(e.target);t.find(":submit[name][value]").each(function(e,n){var i=$(n);if(i.data("clicked")){i.data("clicked",null);var o=t.find('input[name="'+i.attr("name")+'"]').not(":submit");o.length||(o=$("<input>").attr({"type":"hidden","name":i.attr("name")}).addClass("js-submit").appendTo(t)),o.val(i.attr("value"))}})});var n=function(e){$(".description-expander",e).parent().each(function(e,t){var n=$(t),i=n.find(".description-expander"),o=n.find(".description-content-truncated"),r=n.find(".description-content-full"),a=i.is(":checked")?r:o,s=o.data("max-height")||parseInt(o.css("max-height"));o.data("max-height",s);var c=r.attr("style");r.css({"visbility":"hidden","display":"block"});var u=r.outerHeight(!1);if(r.attr("style",c?c:""),u>s){var l=a.children();l=l.add(l.find("a, b, i, strong, em, li"));for(var d=Math.min(s,$(l[0]).outerHeight(!1)),f=a.offset().top,p=1;p<l.length;p++){var h=$(l[p]),g=h.offset().top-f,m=h.outerHeight(!1),v=g+m;s>v&&(d=Math.max(d,v))}o.css("max-height",d+"px")}s>u?n.removeClass("description-ellipsis"):n.addClass("description-ellipsis")})};n(),$(document).on("click",".timeline .feature-banner .js-toggle",function(e){e.preventDefault();var t=$(e.target);$(".js-toggable",t.closest(".feature-banner")).toggleClass("_hidden")}),$(document).on("click",".js-add-assessment",function(e){e.preventDefault(),StackExchange.using("gps",function(){StackExchange.gps.track("story.assessment.prompt.clicked",{"Location":"Header"})}),$("html,body").animate({"scrollTop":$("#item-add").offset().top-20}),$(".item-add.assessment input").click()}),$(document).on("click",".js-scroll-to",function(e){e.preventDefault();var t=$(this).attr("href");$("html,body").animate({"scrollTop":$(t).offset().top-20})}),$(document).on("click",".item-add.assessment",function(e){$(e.target).hasClass("dno")||StackExchange.using("gps",function(){StackExchange.gps.track("story.assessment.prompt.clicked",{"Location":"MenuItem"})})});var i=function(){$.ajax({"url":"/users/story/edit/"+StackExchange.user.options.userId+"/header/featured-assessments","type":"GET","dataType":"html"}).success(function(e){$(".js-featured-assessments").html(e)})},o=function(){var e,t,n=null,i=function(e,i,o){n=$(e).children(".list-card"),n.css({"display":"flex","left":i,"top":o}),t=!0,$(n).hover(function(){n.stop(!0,!0).css("display","flex")},function(){n.css("display","none"),t=!1})};$(document).on("mouseenter",".js-listcard-hover",function(n){var o=n.currentTarget,r=o.offsetParent.offsetWidth,a=o.offsetLeft/r*100+"%",s=o.offsetParent.offsetHeight,c=o.offsetTop/s*100+"%",u=$(o).attr("data-list-url"),l=$(o).closest(".timeline-item-content").children(".js-listcard-container:first");0===$(l).children().length?setTimeout(function(){e=u,$.ajax({"url":u,"type":"GET","dataType":"html"}).success(function(n){$(l).html(n),t||e!==u||i(l,a,c)})},0):i(l,a,c)}),$(document).on("mouseleave",".js-listcard-hover",function(){$(n).delay(100).fadeOut("fast"),t=!1})};o();var r=function(t){if(!t.data("initialized")){t.data("initialized",!0);var i=t.find(".js-tag-editor");i.length&&StackExchange.using("tagEditor",function(){i.each(function(e,t){StackExchange.tagEditor($(t),null,void 0,{"excerpts":!1,"tagMenus":!0})})});var o=t.find(".autocomplete .autocomplete-input");e(o,"input[name='Title']",t,c),o.length&&t.find(".company-tag .delete-tag").click(function(e){$(e.currentTarget).closest(".input-cover").remove(),t.find("input[name='Company'], input[name='Url'], input[name='LogoUrl'], input[name='School'], input[name='ImageUrl']").prop("disabled",!1).eq(0).focus(),t.find("input[name='ListId']").remove(),t.find(".img.logo").removeClass("disabled").addClass("js-img-edit"),t.find(".img .remove").removeClass("dno").addClass("js-img-remove")});var r=t.filter("#form-section-PersonalInfo");if(r.length){var a=!0,s=$(".privacy-helper").data("is-public");r.find(".privacy-wrapper").each(function(e,t){var n=$(t),i=n.find(".privacy-checkbox"),o=i.find("input:checkbox"),r=i.data("target-id"),c=n.find("#"+r),u=!1;o.is(":checked")||(u=!0,a=!1);var l=function(){a&&s||(u=!0,i.show())},d=function(){i.hide()};n.on("focusout",function(){window.setTimeout(function(){$(document.activeElement).closest(n).length||d()},2)}),c.on("keydown",function(){return l()}).on("focus",function(){u&&l()})})}var u=r.find("#form-section-PersonalInfo-Location");if(u.length){var l=t.find("#form-section-PersonalInfo-LocationPlaceId");if(u.typeWatch({"wait":0,"callback":function(){l.val("")},"highlight":!1,"captureLength":-1}),google&&google.maps){var d=new google.maps.places.Autocomplete(u[0],{"types":["geocode"],"fields":["place_id","name","types"]});d.addListener("place_changed",function(){l.val("G:"+d.getPlace().place_id)})}}var f=t.find(".textarea-with-counter textarea");f.length&&f.each(function(e,t){var n=$(t);n.charCounter({"min":StackExchange.options.story.minCompleteBodyLength,"max":4e3,"target":n.closest(".textarea-with-counter").find(".-counter-span"),"ignoreWhitespace":!0,"setIsValid":function(e){var t=n.next(".-counter");t.toggleClass("-success",e),t.toggleClass("-fail",!e),t.find(".-counter-span").toggleClass("dno",e),t.find(".-success-span").toggleClass("dno",!e)}}),n.val()&&n.trigger("charCounterUpdate")}),n(t)}};$(".timeline-item, .header-edit-section").each(function(e,t){r($(t))});var a=function(e,t){var n;if(e&&null!=(n=t.data("order-by"))){for(var i=e.siblings().filter("[data-order-by]").toArray(),o=null,a=0;a<i.length;a++){var s=$(i[a]);if(s.data("order-by")<n){o=s;break}}o?t.insertBefore(o):t.appendTo(".timeline-feed")}else e?t.insertBefore(e):t.insertBefore(".timeline-feed .timeline-item:first");if(e){var c=e.data("next-focus");if(!c){var u=e.find("input:focus");u.length&&(c=u.attr("name"))}c&&t.find("input[name='"+c+"']").focus(),e.remove()}r(t)},s={"get":function(e){"#"!==e.charAt(0)&&(e="#"+e);var t=this[e];return t||(window.location.href="/users/story/"+StackExchange.user.options.userId+"#item-add"),delete this[e],t.find(".js-loader").removeClass("loading"),t},"put":function(e){if(e){var t="#"+e.attr("id");this[t]=e}}},c=function(e,t){var n=m($(e).find(".js-img-edit"));if(t.imageUrl?n.setImage(t.imageUrl,t.resizedImageUrl):n.empty(),$(e).find("input[name='Url']").val(t.url),$(e).find("input[name='Company']").val(t.name),$(e).find("input[name='School']").val(t.name),t.listId){var i=$(e).closest("form"),o=$("<input type='hidden' name='ListId' />").val(t.listId),r=$("<input type='hidden' name='ListClicked' />").val("true");i.find("input[name='ListId']").remove().end().append(o).find("input[name='ListClicked']").remove().end().append(r),i.submit()}$(e).data("next-focus","Title")},u=function(e){try{for(var t=localStorage.length-1;t>=0;t--){var n=localStorage.key(t);0===n.indexOf("DevStory:"+e)&&localStorage.removeItem(n)}}catch(i){}},l=function(e,t){if(t.is("input,textarea,select")&&!t.is("[type=hidden],[type=submit],[type=reset]")){var n=t.attr("name");if(n){var i=t.val();if(t.is("[type=radio],[type=checkbox]")&&(i&&(n+=":"+i),i=t.is(":checked")),n)try{localStorage.setItem("DevStory:"+e+":"+n,i)}catch(o){}}}},d=function(e,t){t.find("input,textarea,select").each(function(t,n){var i=$(n);if(!i.is("[type=hidden],[type=submit],[type=reset]")){var o=i.attr("name");if(o)try{i.is("[type=radio],[type=checkbox]")&&(o+=":"+i.val());var r=localStorage.getItem("DevStory:"+e+":"+o);r&&(i.is("[type=radio],[type=checkbox]")?i.prop("checked","true"===r):i.val(r))}catch(a){}}})},f=function(e){e.preventDefault();var t,n=$(e.target);if(n.attr("data-adds-item")){t=$("#item-add"),t.length||(t=null);var i=s.get("#item-add");t&&i&&(t.replaceWith(i),t=i)}else t=n.closest(".timeline-item");s.put(t),p(n).done(function(e){var i=$(e),o=i.data("typeid"),r=i.is("#item-add"),s=r?"-1":i.attr("id"),c=i.find("form");c.length>0&&d(o+":"+s,c),a(t,i),n.attr("data-scroll-to")&&i[0].scrollIntoView(!0)})},p=function(e){var t="submitting";return e.hasClass(t)?$.Deferred().promise():(e.addClass(t),$.ajax({"type":e.attr("method")||"GET","url":e.attr("action")||e.attr("href"),"data":e.is("form")?e.serialize():null}).always(function(){e.removeClass(t),e.find(".js-submit").remove(),e.find(".js-loader").removeClass("loading")}))};$(document).on("click",".js-loader",function(e){$(e.target).closest(".js-loader").addClass("loading")}),$(document).on("click",".timeline .timeline-item .item-edit-button a",f),$(document).on("click",".timeline .timeline-item.placeholder a.js-add-link",f),$(document).on("submit",".timeline .timeline-item.add form",f),$(document).on("change",".timeline .timeline-item input,textarea,select",function(e){var t=$(e.target),n=t.closest(".timeline-item"),i=n.data("typeid"),o=n.is("#item-add"),r=o?"-1":n.attr("id");l(i+":"+r,t)}),$(document).on("click",".timeline .timeline-item a.item-cancel-button",function(e){var t=e.target,n=$(t),i=n.closest(".timeline-item"),o=s.get(t.hash);o&&(a(i,o),e.preventDefault());var r=i.data("typeid"),c=i.is("#item-add"),l=c?"-1":i.attr("id");u(r+":"+l)}),$(document).on("click",".js-og-request",function(e){e.preventDefault();var t=$.trim($("input[name=Url]").val()),n=$(e.currentTarget).closest("form");if(!t.length)return n.submit();/^https?:/.test(t)||(t="http://"+t);var i=h(t,n),o=i.fail(function(){var e=t.replace("http://","https://");return h(e,n)});o.then(function(e){$(n).find(".js-og-title").val(e.hybridGraph.title),$(n).find(".js-og-image-url").val(e.hybridGraph.image),$(n).find(".js-og-description").val(e.hybridGraph.description),$(n).submit()},function(){$(n).submit()})});var h=function(e){var t="https://opengraph.io/api/1.0/site/"+encodeURIComponent(e)+"?app_id="+StackExchange.settings.userProfile.openGraphAPIKey;return $.ajax({"dataType":"json","url":t}).then(function(e){return e.error?$.Deferred().reject(new Error(e.error)):e})};$(document).on("submit",".timeline .timeline-item.edit form",function(e){e.preventDefault();var t=$(e.target),n=t.closest(".timeline-item"),i=n.is("#item-add"),o=n.data("typeid"),r=$(e.target);p(r).done(function(e){var t=$(e);i&&!t.is("#item-add")?(s.get("#item-add").insertBefore(n),u(o)):i||t.is(".edit")||u(o),a(n,t),w(t)})}),$(document).on("submit",".timeline .timeline-item .item-delete-button form",function(e){e.preventDefault();var t=$(e.target);t.closest(".timeline-item").find(".timeline-item-warning").css("display","flex")}),$(document).on("click",".timeline .timeline-item .timeline-item-warning a.js-btn-warning",function(e){$(e.currentTarget).closest(".timeline-item-warning").hide()}),$(document).on("click",".timeline .timeline-item .timeline-item-warning a.js-btn-confirm",function(e){var t=$(e.currentTarget).closest(".timeline-item").find(".item-delete-button form");p(t).done(function(){var e=t.closest(".timeline-item");e.fadeOutAndRemove(),w(e),e.hasClass("assessment")&&i()})}),$(document).on("change","input[type=checkbox][data-current-for]",function(e){var t=$(e.target),n=$("#"+t.data("current-for"));n.prop("disabled",t.is(":checked")?"disabled":null),n.is("fieldset")&&n.find("select,input").prop("disabled",t.is(":checked")?"disabled":null)});var g=function(e){var t=$(e.target).closest(".autocomplete").find(".autocomplete-suggestions-list").show();$(".autocomplete-suggestions-list").not(t).hide()};$(document).on("click","body",g),$(document).on("focus","body",g),$(document).on("keydown",".autocomplete",function(e){switch(e.which){case 27:var t=$(e.target).closest(".autocomplete");t.find(".autocomplete-suggestions-list").remove(),t.find(".autocomplete-input").focus()}});var m=function(e){var t=$(e),n=t.find("input"),i=t.find("img").not(".js-img-empty"),o={"empty":function(){t.find(".js-img-empty").removeClass("dno"),t.find(".js-img-preview").addClass("dno"),n.val("")},"showDialog":function(){StackExchange.imageUploader.createImageUploadBackground(),StackExchange.imageUploader.uploadImageDialog(function(e){e&&o.setImage(e),StackExchange.imageUploader.removeImageUploadBackground()})},"setImage":function(e,r){e?(n.val(e),r?i.attr("src",r):i.attr("src",e),t.find(".js-img-empty").addClass("dno"),t.find(".js-img-preview").removeClass("dno")):o.empty()}};return o};$(document).on("click",".timeline .js-img-edit",function(e){e.preventDefault();var t=$(e.target),n=m(t.closest(".js-img-edit"));t.closest(".js-img-remove").length?n.empty():n.showDialog()});var v=function(e,t){e.preventDefault();var n=$(e.target),i=n.closest(".header-edit-section");s.put(i),p(n).done(function(e){var n=$(e),o=n.find("form");o.length>0&&d("Header",o),n.insertAfter(i),i.remove(),t&&n.find(t).focus(),r(n)})};$(document).on("click","a.header-edit-btn-ajax",v),$(document).on("click",".header-edit-section-open a.header-cancel",function(e){var t=$(e.target),n=t.closest(".header-edit-section"),i=s.get(n.attr("id"));i&&(e.preventDefault(),i.insertAfter(n),n.remove())}),$(document).on("submit",".header-edit-section-open form",function(e){e.preventDefault();var t=$(e.target),n=t.closest(".header-edit-section"),i=$(e.target);p(i).done(function(e){var t=$(e);t.is(".editing")||u("Header"),t.insertAfter(n),n.remove(),w(t),r(t)})}),$(document).on("change",".header-edit-section input,.header-edit-section textarea, .header-edit-section select",function(e){l("Header",$(e.target))});var b=function(){var e=null,t=function(e){e.removeClass("sticky").removeClass("sticky-bottom")},n=function(){if(e){var n=$(window).scrollTop();n>e.top()?(e.target.addClass("sticky"),n>e.bottom()?e.target.addClass("sticky-bottom"):e.target.removeClass("sticky-bottom")):(t(e.target),e.updateTop())}},i=function(){var n,i,o,r=$(".job-requirements-form"),a=$(".timeline-wrapper"),s=$(".timeline-sidebar"),c=r.add(s);if(s.length){if(s.is(":empty"))return s.remove(),void 0;t(c),r.length&&a.length?(i=r.outerHeight(!0),e={"top":function(){return n},"bottom":function(){var e=a.outerHeight(!0),t=o+e;return t-i},"updateTop":function(){o=a.offset().top,n=r.offset().top},"target":c},e.updateTop()):e=null}};return $(window).on("scroll resize load",n),i}();b(),$(".js-jobs-recommendations").on("recommendations-updated",b);var y=function(e){e=$(e);var t=$(".timeline-sidebar");t.length&&t.remove(),t=$(".timeline-wrapper"),e.appendTo(t),b(),e.find(".job-requirements").is(".js-complete")?$(".timeline").removeClass("requirements-for-jobs"):$(".timeline").addClass("requirements-for-jobs")};$(document).on("submit",".job-requirements-form",function(e){e.preventDefault();var t=$(e.target);p(t).done(y)}),$(document).on("click",".job-requirements .js-min-complete-list a.js-requirement",function(e){var t=$(e.target).closest("a"),n=$(t.attr("data-target")),i=t.data("category"),o=t.data("search-status");if(i&&StackExchange.using("gps",function(){StackExchange.gps.track("min-complete-prompt.click",{"Item":i,"Status":o})}),n.length){$("html,body").animate({"scrollTop":n.offset().top-20});var r=t[0].hash,a=n.find(".header-edit-btn-ajax");if(n.is("#item-add"))if("Assessment"===i)n.find(".assessment input").click(),StackExchange.using("gps",function(){StackExchange.gps.track("story.assessment.prompt.clicked",{"Location":"Sidebar"})});else{var s=n.find(t.attr("data-update-trigger"));s.removeClass("blink"),window.setTimeout(function(){s.addClass("blink")},0)}else"Experience"===i?$(n).find(".item-edit-button a").click():a.length?(e.target=a[0],v(e,r)):n.find(r).focus();e.preventDefault()}});var w=function(e){{var t=!1;$(".job-requirements .js-min-complete-list a[data-update-trigger]").each(function(n,i){t=t||e.is($(i).attr("data-update-trigger"))})}t&&$(".job-requirements-form").submit()};$(document).on("click",".tag-wrapper .js-tag-toggle",function(e){e.preventDefault();var t=$(e.currentTarget);t.closest(".tag-wrapper-item").find(".more").toggleClass("dno"),t.text("more"===t.text()?"fewer":"more")}),$(document).on("submit","form.import-careers-cv-form",function(){return confirm("This will erase your existing Developer Story and recreate it based on your Careers CV. Continue?")})}};var n=!1;StackExchange.user.initOnboarding=function(t){if(!n){n=!0;var i={},o=(t.searchStatus,t.userId),r=function(e){if(!i[e]){var t=$(e);StackExchange.using("tagEditor",function(){initTagRenderer([""],[""]),StackExchange.tagEditor(t),i[e]=!0})}};$(".js-like").is(":visible")&&r(".js-like");var a=function(e){return $.ajax({"type":"POST","url":"/users/story/dismissonboarding/"+o,"data":{"fkey":StackExchange.options.user.fkey,"step":e}})},s=function(e,t){for(var n=0;n<t.length;n++)e.find(".js-error-"+t[n]).show(),e.find("label[for="+t[n]+"]").closest(".input-group").addClass("has-error"),$(".js-onboarding").on("keydown",":input",function(e){$(e.currentTarget).closest(".input-group").removeClass("has-error").find(".js-error").hide()});var i=$(".has-error").first();0!==i.length&&i.scrollIntoView()},c=function(e,t){var n=$(e);if($(".input-group").removeClass("has-error"),$(".js-error").hide(),n.closest(".step").toggleClass("hidden"),$(".hero-step-counter > .completed").toggleClass("hidden"),$(".hero-step-counter > .js-inactive").toggleClass("hidden"),t){$(".js-onboarding .js-step-2").toggleClass("hidden");var i=$('.js-onboarding-work-education input[type="radio"]:checked').data("wrapper-id");l(i)}else $(".js-onboarding .js-step-1").toggleClass("hidden");$(".js-step-counter").scrollIntoView()},u=function(e,t){var n,i=$(e),r=$(".js-onboarding");if(t){var a=$("input[name=add-xp]:checked").attr("id");n=$("#"+a+"-form")}else n=$("#step1form");return $.ajax({"type":"POST","url":"/users/story/"+o+"/onboarding/save","data":n.serialize()}).done(function(e){e.ModelErrors?(s(r,e.ModelErrors),t&&(i.removeClass("loading"),e.JobStoryItemId&&$("#JobStoryItemId").val(e.JobStoryItemId),e.EducationStoryItemId&&$("#EducationStoryItemId").val(e.EducationStoryItemId))):t?(StackExchange.ga.trackFormInputs(n),n.submit()):(StackExchange.ga.trackFormInputs(n),c(i,!0)),t||i.removeClass("loading")})},l=function(t){if("work-experience-wrapper"===t){r(".js-work-tags");var n=$(".autocomplete .js-company-autocomplete"),i=$("input[name='Tags']").next().find("input");e(n,i,n,function(e,t){$("input[name='CompanyName']").val(t.name),$("input[name='CompanyId']").val(t.companyId),$("input[name='ListId']").val(t.listId)})}else r(".js-school-tags")};$(".js-onboarding a.button, .js-onboarding a.btn-confirm").not(".js-prev").on("click",function(e){e.preventDefault();var t=$(e.currentTarget);t.addClass("loading");var n=!!t.data("save-first-item");u(t,n)}),$(".js-onboarding a.js-prev").on("click",function(e){e.preventDefault();var t=$(e.currentTarget);c(t,!1)}),$("input[type=radio][name=SearchStatus]").on("change",function(e){var t=$(e.target),n=$(".js-onboarding");"not-looking"===t.attr("id")?(n.find(".is-required").hide(),n.find(".js-job-recommendations input").prop("checked",!1)):(n.find(".is-required").show(),n.find(".js-job-recommendations input").prop("checked",!0))}),$("#search-status-menu").on("change",function(e){var t=$(e.target);"not-looking"===t.children(":selected").attr("id")?$(".js-onboarding").find(".is-required").hide():$(".js-onboarding").find(".is-required").show()}),$(".js-onboarding .hero-dismiss").on("click",function(e){return a($(e.currentTarget).closest(".step").data("step")).always(function(){window.location.href=window.location.href+(window.location.href.contains("?")?"&":"?")+"_=1"}),!1}),$(".js-current-position, .js-current-education").on("click",function(e){var t=$(e.currentTarget),n=t.parent().prev(".js-enddate-select");n.prop("disabled",t.is(":checked"))}),$('.js-onboarding-work-education input[type="radio"]').on("click",function(e){$(".js-work-experience-wrapper, .js-education-wrapper").hide();var t=$(e.currentTarget).data("wrapper-id");$(".js-"+t).show(),l(t)}),$(".textarea-with-counter textarea").each(function(e,t){$(t).charCounter({"min":StackExchange.options.story.minCompleteBodyLength,"max":4e3,"target":$(t).closest(".textarea-with-counter").find(".-counter-span"),"ignoreWhitespace":!0,"setIsValid":function(e){var n=$(t).next(".-counter");n.toggleClass("-success",e),n.toggleClass("-fail",!e),n.find(".-counter-span").toggleClass("dno",e),n.find(".-success-span").toggleClass("dno",!e)}})})}};var i=!1;StackExchange.user.initJobsOnboarding=function(){function e(e){var t=new RegExp("[?&]"+e+"=([^&]*)").exec(window.location.search);return t?decodeURIComponent(t[1].replace(/\+/g," ")):null}if(!i){i=!0;var t=function(){var e=$(".js-location"),t=$(".js-location-place-id");if(e.length>0){var n=e[0],i={"types":["geocode"],"fields":["place_id","name","types"]};if(google&&google.maps){var o=new google.maps.places.Autocomplete(n,i);o.addListener("place_changed",function(){t.val("G:"+o.getPlace().place_id)})}e.typeWatch({"wait":10,"callback":function(){t.val("")},"highlight":!1,"captureLength":-1})}},n=function(e){StackExchange.tagEditor(e);var t=e.parent().find("div.tag-editor");e.hasClass("error")&&t.addClass("error"),t.find('input[type="text"]').on("focus",function(){t.addClass("focus"),t.removeClass("hover")}),t.find('input[type="text"]').on("focusout",function(){t.removeClass("focus")}),t.on("mouseenter",function(){t.hasClass("focus")||t.addClass("hover")}),t.on("mouseleave",function(){t.removeClass("hover")})},o=function(){StackExchange.using("tagEditor",function(){initTagRenderer("@Tag.RequiredTagsList(Current.Site).AsJavascriptString()".split(" "),"@Tag.ModeratorOnlyTagsList.AsJavascriptString()".split(" ")),$(".js-tags-liked:visible").length>0&&n($(".js-tags-liked")),$(".js-work-tags:visible").length>0&&n($(".js-work-tags")),$(".js-education-tags:visible").length>0&&n($(".js-education-tags"))})},r=function(e,t,n){e.length&&e.typeWatch({"highlight":!1,"wait":500,"captureLength":-1,"callback":function(){e.closest(".coverable-input.input-loader").addClass("loading");var i=$("#min-ds-form").data("user-id");$.ajax({"type":"POST","url":"/users/story/"+i+"/search-lists-autocomplete","data":{"query":e.val(),"fkey":StackExchange.options.user.fkey,"itemType":StackOverflow.Models.Story.UserStoryItemTypeId.Job}}).done(function(i){var o=e.closest(".autocomplete");o.find(".autocomplete-suggestions-list").remove(),e.closest(".coverable-input.input-loader").removeClass("loading");var r=$(i).insertAfter(e);$(".autocomplete-suggestion, .autocomplete-default").on("click",function(e){var i=$(e.currentTarget);if(i.hasClass("autocomplete-default"))return r.hide(),!1;var o=i.data("list-id"),a=i.find(".autocomplete-suggestion-match").text(),s=i.find(".autocomplete-suggestion-image [data-url]").data("url"),c=i.find(".autocomplete-suggestion-url").text();return n&&n(t,{"name":a,"imageUrl":s,"url":c,"listId":o}),r.hide(),!1}),e.is(":focus")||r.hide()})}})},a=function(){var e=$(".autocomplete .js-company-autocomplete");r(e,e,function(e,t){$("input[name='CompanyName']").val(t.name),$("input[name='ListId']").val(t.listId)})},s=function(){t(),o()},c=function(e,n,i){e.fadeOut("fast",function(){$(".js-step-counter").scrollIntoView(),n.fadeIn("slow",function(){i?p($("#user-story-item-type").val()===$("#education-item").val()):(t(),o())})})},u=function(e,t){$(".input-group").removeClass("has-error"),$("div.tag-editor").removeClass("error"),$(".js-error").hide(),e.prop("disabled",!0),$(".js-step-counter .step.completed").toggleClass("hidden"),$(".js-step-counter .step.js-inactive").toggleClass("hidden"),$(".js-step-one").is(":visible")?c($(".js-step-one"),$(".js-step-two"),t):$(".js-step-two").is(":visible")&&c($(".js-step-two"),$(".js-step-one"),t),e.prop("disabled",!1)},l=function(e,t,n,i){for(var o="ResumeUploaderModel",r=0;r<t.length;r++)if(0!=t[r].indexOf(o))e.find(".js-error-"+t[r]).show(),e.find(".js-error-"+t[r]).closest(".input-group").addClass("has-error"),("LikedTags"===t[r]||"JobTags"===t[r]||"Tags"===t[r]||"EducationTags"===t[r])&&e.find("label[for="+t[r]+"]").parent().find("div.tag-editor").addClass("error");else{var a=t[r].substr(o.length+1);$(".resume-error").html(a).show()}$(".js-onboarding").off("input",":input"),$(".js-onboarding").on("input",":input",function(e){if(!i&&n){var t=$(e.currentTarget),o=t.closest(".js-education-wrapper, .js-work-experience-wrapper");o.find('input[type="text"]:not(.tag-editor), textarea').toArray().every(function(e){return""==$(e).val()})&&(o.find(".input-group").removeClass("has-error").find(".js-error").hide(),o.find(".input-group").find("div.tag-editor").removeClass("error"))}}),$(".js-onboarding").off("keydown",":input"),$(".js-onboarding").on("keydown",":input",function(e){var t=$(e.currentTarget).closest(".input-group");t.hasClass("js-tags")&&t.find("div.tag-editor").removeClass("error"),t.removeClass("has-error").find(".js-error").hide()}),$(".js-onboarding").off("click","select"),$(".js-onboarding").on("click","select",function(e){var t=$(e.currentTarget).closest(".input-group");t.removeClass("has-error").find(".js-error").hide()});var s=$(".has-error, .resume-error").first();0!==s.length&&s.scrollIntoView()},d=function(t,n){var i=$("#min-ds-form"),o=$("#min-ds-form").data("user-id"),r=null;return $(".js-step-one").is(":visible")?$(".js-step-two input:hidden").prop("disabled",!0):$(".js-step-two").is(":visible")&&$(".js-step-one input:hidden").prop("disabled",!0),r=i.serialize(),$(".js-step-one").is(":visible")?$(".js-step-two input:hidden").prop("disabled",!1):$(".js-step-two").is(":visible")&&$(".js-step-one input:hidden").prop("disabled",!1),t.addClass("loading"),$(".resume-error").html(null).hide(),$.ajax({"type":"POST","url":"/users/story/"+o+"/onboarding/save","data":r}).done(function(o){if(o.ModelErrors||(StackExchange.ga.trackFormInputs(i),n||StackExchange.ga.trackElement(i)),n)o.ModelErrors?l(i,o.ModelErrors,o.HasSavedResume,n):(void 0!==o.HasSavedResume&&$(".min-ds-content").toggleClass("has-saved-resume",o.HasSavedResume),u(t,!0));else{var r=!1;if(o.ModelErrors&&(l(i,o.ModelErrors,o.HasSavedResume,n),r=!0),o.JobStoryItemId&&$("#JobStoryItemId").val(o.JobStoryItemId),o.EducationStoryItemId&&$("#EducationStoryItemId").val(o.EducationStoryItemId),!r){var a=e("returnUrl");a?window.location.replace(a):o.redirectUrl&&window.location.replace(o.redirectUrl)}}t.removeClass("loading")})},f=function(e){e.trigger("keyup")},p=function(e){e?($("#user-story-item-type").val($("#education-item").val()),$(".js-onboarding-work-education #add-education").prop("checked",!0),$(".js-onboarding-work-education #add-work").prop("checked",!1),f($(".js-education-wrapper .textarea-with-counter textarea"))):($("#user-story-item-type").val($("#job-item").val()),$(".js-onboarding-work-education #add-work").prop("checked",!0),$(".js-onboarding-work-education #add-education").prop("checked",!1),f($(".js-work-experience-wrapper .textarea-with-counter textarea")),a()),o()},h=function(){$('.js-onboarding-work-education input[type="radio"]').on("click",function(e){$(".js-work-experience-wrapper, .js-education-wrapper").hide();var t=$(e.currentTarget).data("wrapper-id");$(".js-"+t).show(),"work-experience-wrapper"===t?p(!1):p(!0)}),$("#wizard-previous-btn").on("click",function(e){return u($(e.currentTarget),!1),!1}),$("#wizard-next-btn").on("click",function(e){return d($(e.currentTarget),!0),!1}),$("#wizard-done-btn").on("click",function(e){return d($(e.currentTarget),!1),!1}),$(".js-work-is-current, .js-education-is-current").on("click",function(e){var t=$(e.target),n=t.is(".js-work-is-current")?$(".js-work-end-year"):$(".js-education-end-year");t.is(":checked")?n.prop("disabled",!0):n.prop("disabled",!1)}),$(".js-work-end-year, .js-education-end-year").change(function(e){var t=$(e.currentTarget),n=t.is(".js-work-end-year")?$(".js-work-start-year"):$(".js-education-start-year"),i=t.is(".js-work-end-year")?$(".js-work-end-year"):$(".js-education-end-year"),o=parseInt(n.val(),10),r=parseInt(i.val(),10);o>r&&n.val(r)}),$(".js-work-start-year, .js-education-start-year").change(function(e){var t=$(e.currentTarget),n=t.is(".js-work-start-year")?$(".js-work-start-year"):$(".js-education-start-year"),i=t.is(".js-work-start-year")?$(".js-work-end-year"):$(".js-education-end-year");
if(i.length>0){var o=parseInt(n.val(),10),r=parseInt(i.val(),10);o>r&&r>0&&i.val(o)}}),$(".textarea-with-counter textarea").each(function(e,t){$(t).charCounter({"min":StackExchange.options.story.minCompleteBodyLength,"max":4e3,"target":$(t).closest(".textarea-with-counter").find(".-counter-span"),"ignoreWhitespace":!0,"setIsValid":function(e){var n=$(t).next(".-counter");n.toggleClass("-success",e),n.toggleClass("-fail",!e),n.find(".-counter-span").toggleClass("dno",e),n.find(".-success-span").toggleClass("dno",!e)}})}),$("input[type=radio][name=SearchStatus]").on("change",function(e){var t=$(e.target),n=$(".js-onboarding");"SearchState-NotLooking"===t.attr("id")?n.find(".js-job-recommendations input").prop("checked",!1):n.find(".js-job-recommendations input").prop("checked",!0)}),p($("#user-story-item-type").val()===$("#education-item").val())};s(),h()}},StackExchange.user.handleListImageError=function(e){$(e).parent("div").hide().prev(".js-logo-blank").css("display","flex");var t=$(e).data("list-id");return t?$.ajax({"type":"POST","url":"/users/story/lists/enqueue-for-logo-update","data":{"fkey":StackExchange.options.user.fkey,"listId":t}}):void 0};var o=!1;StackExchange.user.initJobSearchPreferences=function(){function e(e,t){StackExchange.helpers.showMobileMessage(e,t),$("body").scrollIntoView()}function t(e,t,i,o){var r=b.find(".js-disliked-company-id").filter(function(t,n){return $(n).val()==e});if(0==r.length){var a=(n(t),$(".js-disliked-company-template").clone().removeClass("js-disliked-company-template").removeClass("d-none").data("id",e));a.find(".js-disliked-company-name").html(t),a.find(".js-disliked-company-img").attr("src",o),a.find(".js-disliked-company-id").val(e).attr("name",a.data("id-field-name"));var s=a.find(".js-disliked-company-link");s.attr("href",s.attr("href")+i),b.prepend(a)}}function n(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}if(!o){o=!0,StackExchange.using("tagEditor",function(){var e={"suggestionsWidth":StackExchange.options.isMobile?null:466};StackExchange.tagEditor($("#technologies-like"),null,null,e),StackExchange.tagEditor($("#technologies-dislike"),null,null,e)});var i=$("#location-widget"),r=$("#location-items"),a=$("#location-address"),s=$("#location-place-id"),c=$("#location-add"),u=$("#location-home-item"),l=$("#location-include-home"),d=$("#geo-tag-template").html(),f=r.data("initial")||[],p=$("input[name='SearchStatus']"),h=$(".js-salary"),g=$(".js-more"),m=$("#notify-container"),v=$(".js-disliked-companies-autocomplete"),b=$(".js-disliked-companies");h.keydown(function(e){return e.key&&1===e.key.length&&!/[0-9]/.test(e.key)?!1:void 0}),l.change(function(e){$(e.currentTarget).is(":checked")?u.removeClass("dno"):u.addClass("dno")});var y=function(){r.find(".geo-tag").not(u).remove();for(var e=0;e<f.length;e++){var t=f[e],n=$.extend({"i":e,"NeedsVisaClass":t.NeedsVisa?"needs-visa":""},t);$(d.formatUnicorn(n)).appendTo(r)}};if(r.on("click",".delete-location",function(e){e.preventDefault();var t=$(e.target).closest(".geo-tag[data-index]");t.length&&1===f.splice(t.data("index"),1).length&&y()}),c.click(function(e){e.preventDefault();var t={};i.find("[data-property]").each(function(e,n){var i=$(n);t[i.data("property")]=i.is("input[type=checkbox]")?i.is(":checked"):i.val(),i.val("").prop("checked",!1)}),f.push(t),y(),c.prop("disabled",!0)}),a.typeWatch({"wait":10,"callback":function(){s.val(""),c.prop("disabled",!0)},"highlight":!1,"captureLength":-1}),google&&google.maps){var w={"types":["geocode"]},k=new google.maps.places.Autocomplete(a[0],w);k.addListener("place_changed",function(){var e=k.getPlace(),t=e.address_components.reduce(function(e,t){return{"types":e.types.concat(t.types)}}).types;t.indexOf("country")>=0&&(s.val("G:"+e.place_id),c.prop("disabled",!1))})}var x=function(e,t){e=e.chosen(t);var n=function(t){var n=e.data("name");if(n){e.next().find(".search-choice-close").removeClass("search-choice-close").addClass("delete-tag");var i=e.parent();i.find('[name^="{0}["]'.formatUnicorn(n)).remove();var o=e.val()||[];$.each(o,function(e){$("<input>").attr({"type":"hidden","name":"{0}[{1}]".formatUnicorn(n,e),"value":o[e]}).appendTo(i)}),t===!0&&StackExchange.ga.recordInputChange(e)}};e.change(function(){return n(!0)}),n()};x($("#developer-roles"),{"max_selected_options":StackExchange.options.jobPreferences.maxNumDeveloperRoles}),x($("#industries-liked"),{"max_selected_options":StackExchange.options.jobPreferences.maxNumIndustries}),x($("#industries-disliked")),p.on("change",function(){p.each(function(e,t){var n=$(t),i=n.parent("label").siblings(".opt-in-message");n.is(":checked")?i.css("visibility","visible"):i.css("visibility","hidden")})});var S=function(e,t){e.siblings(".tag-editor").toggleClass("has-error",t),e.siblings(".error-message").toggle(t)},E={"technologies-like":StackExchange.options.story.likedTagsMaxLength,"technologies-dislike":StackExchange.options.story.dislikedTagsMaxLength};$("#technologies-like, #technologies-dislike").on("keydown keyup change paste",function(e){var t=$(e.target);S(t,t.val().length>E[t.attr("id")])}),v.autoComplete({"menuClass":"bg-white ps-absolute z-modal overflow-x-hidden overflow-y-auto bx bb bc-black-4 bs-md is-visible c-pointer company-page-autocomplete","minChars":1,"source":function(e,t){try{i.abort()}catch(n){}var i=$.getJSON("/jobs/get-companies",{"term":e,"max":6},function(e){t(e)})},"renderItem":function(e,t){t=t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");var i=n(e.CompanyName),o=new RegExp("("+t.split(" ").join("|")+")","gi");return'<div class="ps-relative grid fl1 p8 lh-lg fc-black-700 autocomplete-suggestion"'+(' data-id="'+e.Id+'"')+(' data-name="'+i+'"')+(' data-logo-url="'+e.LogoUrl+'"')+(' data-slug="'+e.Slug+'">')+('<img class="grid--cell -logo" src="'+e.LogoUrl+'" />')+('<span class="grid--cell pl6 truncate">'+i.replace(o,"<span class='fw-bold td-underline'>$1</span>")+"</span>")+"</div>"},"onSelect":function(e,n,i){var o=i.data("id"),r=i.data("name"),a=i.data("slug"),s=i.data("logo-url");t(o,r,a,s),$(this).focus(),e.preventDefault()}}),b.on("click",".js-close",function(e){return $(this).closest(".js-disliked-company").remove(),e.preventDefault(),!1});var C=$("form#jobPreferencesForm");C.on("submit",function(t){t.preventDefault(),m.html("");var n=C.serialize();return StackExchange.helpers.addSpinner($("#spinnerContainer")),$.ajax({"type":"POST","url":C.attr("action"),"data":n}).done(function(){var t=p.filter(":checked"),n=!t.data("was-checked");n&&StackExchange.ga.track("Account Management","Job Search Status Change Save",t.data("label")),StackExchange.options.isMobile?e("<b>Success!</b> Your Job Preferences have been saved.","success"):window.location.href=window.location.href}).fail(function(t){if(400===t.status){var n=t.responseJSON;if(n.industriesTooLong||n.developerRolesTooLong){var i=n.industriesTooLong?"Add up to "+StackExchange.options.jobPreferences.maxNumIndustries+" industries only":"Add up to "+StackExchange.options.jobPreferences.maxNumDeveloperRoles+" roles only";if(StackExchange.options.isMobile)e(i,"warning");else{var o={"type":"error","position":"toast","transient":!0,"transientDuration":4e3};StackExchange.helpers.showMessage($("body"),i,o)}return}n.likedTagsTooLong&&S($("#technologies-like"),!0),n.dislikedTagsTooLong&&S($("#technologies-dislike"),!0),null!=n.savedResumeError&&n.savedResumeError.length>0?($(".resume-error").html(n.savedResumeError).show(),$(".js-resume-uploader").scrollIntoView()):$("#tags").scrollIntoView()}else StackExchange.options.isMobile?e("Sorry, something went wrong","error"):$("#save-error-message").show().scrollIntoView()}).always(function(){StackExchange.helpers.removeSpinner()}),!1}),$(".js-save-job-preferences").click(function(){C.submit()}),g.click(function(){var e=$(this),t=e.siblings(".-more-item"),n=t.first(),i=!n.hasClass("dno");if(i){var o=e.offset().top-n.offset().top,r=$("body").scrollTop()-o;$("body").scrollTop(r)}return t.toggleClass("dno"),e.html(i?"+ More":"- Less"),!1})}};var r=!1;StackExchange.user.initCvView=function(){r||(r=!0,$(".js-cv-story").on("click",".js-toggle-more",function(){var e=$(this),t=e.closest("section, .section, .js-subsection"),n=t.find(".js-hidden-item");n.toggleClass("d-none");var i=e.data("fewer-text"),o=e.data("more-text"),r=e.html();e.html(n.filter(":hidden").length?r.replace(i,o):r.replace(o,i))}))},StackExchange.user.initListEditor=function(){var e=$("a.js-edit-list"),t=$("header.js-edit-list"),n=$("form.js-delete-list"),i=t.prev("header");e.click(function(e){e.preventDefault(),t.removeClass("hidden"),i.addClass("hidden")}),n.submit(function(e){e.preventDefault();var t=$(e.currentTarget);confirm("Are you sure you want to delete this list?")&&$.ajax({"type":"POST","url":t.attr("action"),"data":t.serialize()}).done(function(e){e.success&&$("#content").prepend(e.message)})});var o=function(e){var t=$(e),n=t.find("input"),i=t.find("img").not(".js-img-empty"),o={"empty":function(){t.find(".js-img-empty").removeClass("dno"),t.find(".js-img-preview").addClass("dno"),n.val("")},"showDialog":function(){StackExchange.imageUploader.createImageUploadBackground(),StackExchange.imageUploader.uploadImageDialog(function(e){e&&o.setImage(e),StackExchange.imageUploader.removeImageUploadBackground()})},"setImage":function(e){e?(n.val(e),i.attr("src",e),t.find(".js-img-empty").addClass("dno"),t.find(".js-img-preview").removeClass("dno")):o.empty()}};return o};t.on("click",".js-img-edit",function(e){e.preventDefault();var t=$(e.target),n=o(t.closest(".js-img-edit"));t.closest(".js-img-remove").length?n.empty():n.showDialog()}),$(".js-cancel-edit").click(function(e){e.preventDefault(),t.addClass("hidden"),i.removeClass("hidden")})};var a=!1;StackExchange.user.initJobRecommendations=function(e){if(!a){a=!0;var t=function(){$.ajax({"type":"POST","url":"/users/story/fetch-jobs-recommendations/"+StackExchange.user.options.userId,"data":{"source":e,"fkey":StackExchange.options.user.fkey}}).done(function(e){var t=$(".js-jobs-recommendations");t.append(e),StackExchange.ga.bindHandlers(t),t.trigger("recommendations-updated")})},n=function(e){return $.ajax({"type":"POST","url":"/users/story/toggle-jobs-recommendations/"+StackExchange.user.options.userId,"data":{"fkey":StackExchange.options.user.fkey,"collapseJobs":e}})};$(document).on("click",".js-toggle-jobs",function(){var e=$(".js-sidebar-jobs-visible").hasClass("is-visible");n(e).always(function(){$(".js-sidebar-jobs-visible, .js-sidebar-jobs-hidden").toggleClass("is-visible is-hidden")})}),$(document).on("click",".js-jobs-recommendations a",function(t){var n=$(t.target).closest(".js-click-target"),i=n.data("target");StackExchange.using("gps",function(){StackExchange.gps.track("story_sidebar.jobs_recommendations.click",{"target":i,"source":e})})}),t()}};var s=!1;StackExchange.user.initResumeUploader=function(e){if(!s){s=!0;try{c.init(e)}catch(t){$("#uploader-wrapper .loading-text").html("Loading failed.")}}};var c;!function(e){function t(e){function t(){null!==g&&(clearTimeout(g),g=null)}function n(e,n){$("input[name='HasSavedResume']").val("True"),$("input[name='SavedResumeId']").val(e).trigger("change"),$(".saved-resume-filename").text(n),$(".upload-complete").fadeIn(100),t(),g=setTimeout(function(){$(".upload-complete").fadeOut(),t()},15e3),i(e,n),$(".js-resume-uploader").addClass("has-resume")}function i(e,t){$(".download-saved-resume").attr("href","/jobs/resume/download?savedResumeId="+e).attr("download",t).show()}function o(e){switch(e){case 0:return"GoogleDrive";case 1:return"Dropbox";default:return"None"}}function r(e){switch(e){case 0:return 1;case 1:return 2;default:throw"Invalid external resume source"}}function a(e){s(e)}function s(e){var t=o(e.source);$(".uploading-filename").text(e.displayName),$(".resume-error").html(null).hide(),$(".uploading-text").html("Fetching from "+t),$(".js-saved-resume-visible-to-employers").prop("checked",!0),m.addClass("is-fetching-external-resume"),$.post("/jobs/resume/fetch-from-external-source",{"fkey":StackExchange.options.user.fkey,"Source":r(e.source),"Location":e.location,"AuthToken":e.authToken,"Filename":e.displayName}).then(function(e){m.removeClass("is-fetching-external-resume"),e.Success?n(e.SavedResumeId,e.Filename):$(".resume-error").html(e.ErrorMessage).show()},function(){m.removeClass("is-fetching-external-resume"),$(".resume-error").html("An unknown error occurred").show()})}function c(e){var t="There was an error.";e&&("string"==typeof e?t=e:e instanceof Error&&(t=e.message)),$(".resume-error").text(t).show()}function u(t){return new Promise(function(n,i){switch(t){case 0:window.gapi.auth.authorize({"client_id":e.googleDrive.clientId,"scope":["https://www.googleapis.com/auth/drive.readonly"],"immediate":!1},function(t){if(t&&!t.error){var o=Math.min(Math.max(window.innerWidth,350),650),r=Math.min(Math.max(window.innerHeight,566),1051),a=(new google.picker.PickerBuilder).addView(google.picker.ViewId.DOCUMENTS).addView(google.picker.ViewId.PDFS).setOAuthToken(t.access_token).setAppId(e.googleDrive.appId).setSize(o,r).setDeveloperKey(e.googleDrive.developerKey).setCallback(function(e){l(e,t.access_token).then(n,i)}).build();a.setVisible(!0)}});break;case 1:Dropbox.choose({"success":function(e){d(e).then(n,i)},"linkType":"direct","extensions":[".pdf",".doc",".docx",".odt",".txt"]})}})}function l(e,t){return new Promise(function(n){if(e&&e[google.picker.Response.ACTION]===google.picker.Action.PICKED){var i=e[google.picker.Response.DOCUMENTS][0];if(i){var o=i[google.picker.Document.ID],r=i[google.picker.Document.MIME_TYPE],a=i[google.picker.Document.NAME];"application/vnd.google-apps.document"===r&&(a+=".pdf"),n({"source":0,"location":o,"authToken":t,"displayName":a})}}})}function d(t){return new Promise(function(n,i){if(t.length>0){var o=t[0];o.bytes>e.maxResumeUploadSize?i(new Error("Resume file is too large. Please limit resume to "+e.maxResumeUploadSize+" bytes.")):n({"source":1,"location":o.link,"displayName":o.name})}})}var f=document.getElementById("uploader-wrapper");if(null!==f){var p="";window.Dropbox&&Dropbox.isBrowserSupported()?(p='<a href="#" class="js-dropbox-trigger">Dropbox</a>',$("#uploader-wrapper").on("click",".js-dropbox-trigger",function(e){e.preventDefault(),u(1).then(a,c)})):$("button.js-dropbox-trigger").hide();var h="";window.gapi?(h='<a href="#" class="js-google-drive-trigger">Google Drive</a>',window.gapi.load("auth",function(){}),window.gapi.load("picker",function(){}),$("#uploader-wrapper").on("click",".js-google-drive-trigger",function(e){e.preventDefault(),u(0).then(a,c)})):$("button.js-google-drive-trigger").hide();var g=null,m=$(".js-resume-uploader");if(m.hasClass("js-resume-uploader-full")){{new qq.FineUploader({"element":f,"multiple":!1,"request":{"endpoint":"/jobs/resume/upload","params":{"fkey":StackExchange.options.user.fkey}},"text":{"fileInputTitle":""},"validation":{"allowedExtensions":e.allowedFileExtensions,"sizeLimit":e.maxResumeUploadSize},"callbacks":{"onTotalProgress":function(e,t){var n=Math.floor(100*e/t);n=Math.min(n,100),100==n?($(".uploading-text").html("Scanning for viruses"),m.removeClass("is-uploading"),m.addClass("is-virus-scanning")):$(".uploading-text").html(n+"% Complete")},"onValidate":function(e){var t=window.qq.Promise,n=new t;return/[\/\\:\*\?"<>\|]/.test(e.name)?($(".resume-error").html("The file name is invalid").show(),n.failure(!1)):n.success(!0),n},"onSubmit":function(e,t){$(".uploading-filename").text(t),$(".uploading-text").html("0% Complete"),$(".resume-error").html(null).hide(),$(".js-saved-resume-visible-to-employers").prop("checked",!0),m.addClass("is-uploading")},"onComplete":function(e,t,i){m.removeClass("is-uploading").removeClass("is-virus-scanning"),$(".uploading-text").html(null),i.success?n(i.savedResumeId,i.filename):$(".resume-error").html(i.message).show()},"onError":function(e,t,n){return m.removeClass("is-uploading").removeClass("is-virus-scanning"),$(".uploading-text").html(null),"XHR returned response code 0"==n?($(".resume-error").html("A network error has occurred. Are you connected to the internet?").show(),void 0):(-1==n.indexOf("has an invalid extension.")&&-1==n.indexOf("is too large")&&"XHR returned response code 400"!=n&&alert("Error on file upload: "+n),void 0)}}})}""!==h&&$("#uploader-wrapper .upload-text .js-google-drive-link").html((""===p?" or ":", ")+h),""!==p&&$("#uploader-wrapper .upload-text .js-dropbox-link").html((""===h?" or ":", or ")+p)}$("body").on("click",".js-remove-saved-resume",function(){$("input[name='SavedResumeId']").val(null).trigger("change"),$("input[name='HasSavedResume']").val("False"),$(".js-saved-resume-visible-to-employers").prop("checked",!1),$(".resume-error").hide(),$(".js-resume-uploader").removeClass("has-resume"),$(".upload-complete").hide(),$(".js-last-saved-resume-updated-date").hide(),t()})}}e.init=t}(c||(c={}))}(StackExchangeDevStory||(StackExchangeDevStory={}));var StackOverflow;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){e[e.Job=1]="Job",e[e.PublicArtifact=2]="PublicArtifact",e[e.TopPost=3]="TopPost",e[e.AppsAndSoftware=4]="AppsAndSoftware",e[e.Education=5]="Education",e[e.Certification=6]="Certification",e[e.Generic=10]="Generic",e[e.AutoGenerated=99]="AutoGenerated",e[e.OpenSource=100]="OpenSource",e[e.Reading=200]="Reading"}(t=e.UserStoryItemTypeId||(e.UserStoryItemTypeId={}))}(t=e.Story||(e.Story={}))}(t=e.Models||(e.Models={}))}(StackOverflow||(StackOverflow={}));